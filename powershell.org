:PROPERTIES:
:ID:       96a3594c-4691-4063-949d-e6152fd62fea
:ROAM_REFS: https://docs.microsoft.com/en-us/powershell/
:END:
#+title: PowerShell

* Cheat Sheet

** PowerShell Introspection

#+caption: Example of getting help for the 'Get-Help' command
#+begin_src powershell
Get-Help Get-Help
#+end_src

#+caption: Example of listing out all commands containing the string 'Fire'
#+begin_src powershell
Get-Command '*Fire*'
#+end_src

** Show the Route an IP address would take

#+begin_src powershell
Find-NetRoute -RemoteIpAddress "${IP_ADDRESS}"
#+end_src

** Test TCP Connections

#+begin_src powershell
Test-NetConnection -ComputerName ${IP_ADDRESS} -Port ${PORT}
#+end_src

** Windows Defender Firewall

*** New-NetFirewallRule
   :PROPERTIES:
   :ID:       053f26d8-91a7-49af-b244-ec5b1b43f639
   :ROAM_EXCLUDE: t
   :ROAM_REFS: https://docs.microsoft.com/en-us/powershell/module/netsecurity/new-netfirewallrule
   :END:

#+caption: Allow incoming traffic on port 80 from any source.
#+begin_src powershell
New-NetFirewallRule -DisplayName “Allow Inbound HTTP” -Enabled True -Direction Inbound -Action Allow -Protocol TCP -LocalPort 80
#+end_src

*** Remove-NetFirewallRule
   :PROPERTIES:
   :ID:       783dd9da-b9c9-4648-905f-11dafb638b19
   :ROAM_EXCLUDE: t
   :ROAM_REFS: https://docs.microsoft.com/en-us/powershell/module/netsecurity/remove-netfirewallrule
   :END:

#+caption: Delete rules with DisplayName “Allow Inbound HTTP”
#+begin_src powershell
Remove-NetFirewallRule -DisplayName “Allow Inbound HTTP”
#+end_src
